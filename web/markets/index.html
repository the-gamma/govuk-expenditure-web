<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
  <meta name=viewport content="width=device-width, initial-scale=1">
  <title>Expected and Unexpected | The Alan Turing Institute</title>
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"
    integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link href="https://thegamma.net/lib/thegamma/thegamma.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Inconsolata|Roboto:300,400,500,700,900" rel="stylesheet">
  <link href="/lib/custom.css" rel="stylesheet">
  
  <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon-big.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/img/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/img/favicon-big.png">

  <meta name="msapplication-TileColor" content="#3D46FF">
  <meta name="msapplication-TileImage" content="/img/favicon-big.png">
  <meta name="theme-color" content="#00202D">    
  
  <meta name="description" content="Deciding what events affect the financial markets can sometimes 
    be easy. The fact that the value of Pound dropped following Brexit is likely a causation. The 
    fact that the value of Pound went up following the return of the astronaut Tim Peake is certainly 
    a pure coincidence. Sometimes, making a good guess can be a lot harder. For example, would Brexit 
    affect the FTSE index? In this article, you get to make your guess!" />
  <meta name="keywords" content="market, brexit, financial crisis, turing institute, thegamma, data journalism, data science" />  
  <meta name="author" content="Tomas Petricek and May Yong" />
  <meta name="copyright" content="Tha Alan Turing Institute" />
  
  <meta property="og:title" content="Expected and Unexpected" />
  <meta property="og:type" content="article" />
  <meta property="og:url" content="http://gamma.turing.ac.uk/markets/" />
  <meta property="og:image" content="http://thegamma-turing-web.azurewebsites.net/markets/card.png" />
  <meta property="og:description" content="Deciding what events affect the financial markets can sometimes 
    be easy. The fact that the value of Pound dropped following Brexit is likely a causation. The 
    fact that the value of Pound went up following the return of the astronaut Tim Peake is certainly 
    a pure coincidence. Sometimes, making a good guess can be a lot harder. For example, would Brexit 
    affect the FTSE index? In this article, you get to make your guess!" />
  
  <meta name="twitter:card" content="summary_large_image">  
  <meta name="twitter:site" content="@thegamma_net">
  <meta name="twitter:creator" content="@thegamma_net">  
  <meta name="twitter:title" content="Expected and Unexpected" />
  <meta name="twitter:image" content="http://thegamma-turing-web.azurewebsites.net/markets/card.png" />
  <meta name="twitter:description" content="Deciding what events affect the financial markets can sometimes 
    be easy. The fact that the value of Pound dropped following Brexit is likely a causation. The 
    fact that the value of Pound went up following the return of the astronaut Tim Peake is certainly 
    a pure coincidence. Sometimes, making a good guess can be a lot harder. For example, would Brexit 
    affect the FTSE index? In this article, you get to make your guess!" />
    
  <script type="application/ld+json">
  {
  	"@context": "http:\/\/schema.org",
  	"@type": "Article",
  	"name": "Expected and Unexpected",
    "headline": "Can you guess whatevents affect the financial markets?",
  	"description": "The fact that the value of Pound dropped following Brexit is likely a causation. The fact that the value of Pound went up following the return of the astronaut Tim Peake is certainly a pure coincidence. Sometimes, making a good guess can be a lot harder. For example, would Brexit affect the FTSE index? In this article, you get to make your guess!",
  	"url": "http://gamma.turing.ac.uk/markets/",
  	"author": [{
      "@type": "Person",
  		"name": "Tomas Petricek",
  		"url": "http://tomasp.net",
  		"sameAs": ["http://twitter.com/tomaspetricek"]
  	}, {
      "@type": "Person",
  		"name": "May Yong"
  	}],
  	"creator": ["Tomas Petricek"],
  	"dateCreated": "2017-12-13T13:27:17.4779884+01:00",
  	"datePublished": "2017-12-13T13:27:17.4779884+01:00",
    "dateModified": "2017-12-13T13:27:17.4779884+01:00",
    "mainEntityOfPage": "http://gamma.turing.ac.uk/markets/",
  	"image": "http://thegamma-turing-web.azurewebsites.net/markets/card.png",
  	"thumbnailUrl": "http://thegamma-turing-web.azurewebsites.net/markets/card.png",
  	"keywords": ["financial crisis", "markets", "brexit", "turing institute", "thegamma", "data journalism", "data science"],
  	"inLanguage": "en-us",
  	"publisher": {
  		"@type": "Organization",
  		"name": "The Alan Turing Institute",
  		"url": "http://turing.ac.uk",
      "logo": "http://thegamma-turing-web.azurewebsites.net/img/turing.png"
  	}
  }  
  </script>    
  <script type="text/javascript">
    var thegamma = [];
  </script>
</head>
<body>
  <div id="trig"><div id="trig1purple"></div></div>

  <article class="container">
  <div class="row">
    <div class="col-sm-10 col-lg-8">
      <h1>The Alan Turing Institute<br/><em>Expected and unexpected</em></h1>
      <p class="article-info-sm">
        <a target="_blank" href="https://twitter.com/intent/tweet?url=http%3a%2f%2fgamma.turing.ac.uk%2fmarkets&amp;text=Expected+and+Unexpected+-+Interactive+%23dataviz+using+%40thegamma_net+by+%40turinginst+%23ddj">
          <i class="fa fa-twitter-square"></i></a>
        <a target="_blank" href="https://www.facebook.com/sharer.php?u=http%3a%2f%2fgamma.turing.ac.uk%2fmarkets">
          <i class="fa fa-facebook-official"></i></a>
        <a href="mailto:?subject=Expected%20and%20Unexpected%20%7c%20The%20Alan%20Turing%20Institute&body=See%3a%20http%3a%2f%2fgamma.turing.ac.uk%2fmarkets">
          <i class="fa fa-envelope"></i></a>
        <a href="http://www.reddit.com/submit?url=http%3a%2f%2fgamma.turing.ac.uk%2fmarkets&title=Expected+and+Unexpected+%7c+The+Alan+Turing+Institute">
          <i class="fa fa-reddit-square"></i></a>
        <a target="_blank" href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Fgamma.turing.ac.uk%2fmarkets&t=Expected%20and%20Unexpected%20-%20The%20Alan%20Turing%20Institute">
          <i class="fa fa-hacker-news"></i></a>
      </p>
      <p>
        Deciding what events affect the financial markets can sometimes be easy.
        The fact that the value of Pound dropped following Brexit is likely
        a causation. The fact that the value of Pound went up following the return of the
        astronaut Tim Peake is certainly a pure coincidence. Sometimes, making a 
        good guess can be a lot harder. For example, would Brexit affect the 
        FTSE index? In this article, you get to make your guess!
      </p>
      <p>
        In the time of fake news, can you be sure that an article like this 
        show you genuine events and prices, rather than making the story up? 
        To leave no doubt, this article is created using <a href="http://thegamma.net">The Gamma 
        project</a>, which lets you trace the data back to the originl source.
        We're using events from Wikipedia and exchange rates published by the 
        Bank of England and you can check, on your own, that this is the case!
      </p>
    </div>
  </div>
    
  <div class="row">
    <div class="col-sm-12 col-md-8">
      <h2><span>Exploring the events of 2016</span></h2>
      <p>First, let's talk about transparency. If you wanted to check that the
        dates and descriptions of events in an ordinary article are accurate,
        you would have to do this by hand, perhaps by going to the 
        Wikipedia page <a href="https://en.wikipedia.org/wiki/2016_in_the_United_Kingdom">2016 in 
        the United Kingdom</a> and then check the dates of events in a chart,
        one by one. You do not need to do any of that in this article, because we fetch
        the events <em>directly</em> from Wikipedia and we invite you to explore
        how we do it!
      </p>
      <p>
        When you load this page, we run the following <a href="https://thegamma.net">TheGamma</a>
        script to get 2016 events in the UK from Wikipedia, choose those mentioning Jeremy 
        Corbyn and show them in a table. If you click on <code>scrapeDatedLists</code> in 
        the editor, you will see the source Wikipedia page. If you then replace Jeremy Corbyn 
        with Theresa May and click "refresh the output", we'll fetch the events of your choice, 
        so you can see we are not cheating!
      </p>
    </div>
  </div>

  <div class="row">
    <div class="col-sm-12"><div class="thegamma">
      <div class='thegamma-edit'><a id="simple-ok" href='javascript:;'><i class='fa fa-refresh'></i> refresh the output</a></div>
      <div id="simple-ed-wrapper" style="padding:25px 0px 0px 0px;">
        <div id="simple-ed"></div>
        <div id="simple-ed-errors" class="errors" style="position:static;"></div>
      </div>
    </div></div>
  </div>
  <div class="row">
    <div class="col-sm-8 thegamma">        
      <style>#simple-out table td, #simple-out table th { min-width:140px; font-size:12pt; } </style>
      <div id="simple-out-wrapper" style="padding:0px;">
        <div id="simple-out" class="output">
          <div class="placeholder">
            Loading the visualization...
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-4 hidden-xs">
      <h3><span>Don't be afraid to experiment</span></h3>
      <p>You do not need to be a programmer to make a few simple changes in the script!</p>
      <p>First, change "Jeremy Corbyn" to "Theresa May" or other name or place you want to search 
        for. As you type, you will see a preview of the filtered events and if you move the cursor 
        to the last line, you'll see a preview of the resulting table. When you're done, click
        "refresh the output" and we'll update the table on the left!</p>
      <p>Second, change 2016 to 2017 in the Wikipedia address. The 2017 page does not list any
        events mentioning Jeremy Corbyn, so you'll need to change the filter too. You can 
        also use a link for <a href="https://en.wikipedia.org/wiki/2016_in_the_United_States">2016 
        events in the USA</a> or many other event listing pages from Wikipedia.</p>
    </div>
  </div>
  
<script id="simple-demo" type="text/thegamma">let ukEvents = "https://en.wikipedia.org/wiki/2016_in_the_United_Kingdom"

let corbyn = web.scrapeDatedLists(ukEvents, 2016).explore
  .'filter data'.'Type is'.'Events[edit]'.then
  .'filter data'.'Entry contains'("Jeremy Corbyn").then
  .'drop columns'.'drop Type'.then
  .'sort data'.'by Date'.then
  .'get the data'
    
table.create(corbyn).setFormat("Date", dateformat.longDate)</script>
    
    <div class="row">
      <div class="col-sm-6 toppad">
        <h2><span>How Brexit affected the pound?</span></h2>
        <p>Before Brexit, £1 was worth $1.46. After Brexit, £1 was worth $1.28.
          How exactly did the drop happen? Has the pound started losing value in advance, before
          the vote on June 24, or did the drop happen after the vote? And has the value 
          recovered after Theresa May became Prime Minister-designate?</p>
        <p>The following visualization shows the important events side-by-side with the
          exchange rate between pound sterling and US dollar. If you click "open source code",
          you can see our data sources - the events come from Wikipedia and exchange rate
          is obtained from the Bank of England.</p>
        <div class="thegamma" id="gbpusd-brexit-list"></div>
      </div>
      <div class="toppad col-sm-4">
        <div class="hidden-xs" style="height:100px"></div>
        <div class="thegamma" id="gbpusd-brexit"></div>
      </div>
    </div>

<script type="text/thegamma" id="gbpusd-brexit-code">let bank = "http://www.bankofengland.co.uk/boeapps/iadb/fromshowcolumns.asp?Travel=NIxRSxSUx" + 
  "&FromSeries=1&ToSeries=50&DAT=RNG&FD=1&FM=Jan&FY=2016&TD=1&TM=Jan&TY=2017" + 
  "&VFD=N&csv.x=17&csv.y=24&CSVF=TN&C=C8P&Filter=N"

let gbpusd = 
  web.loadTable(bank).explore
    .'get series'.'with key DATE'.'and value XUDLUSS'

let markers = 
  web.scrapeDatedLists("https://en.wikipedia.org/wiki/2016_in_the_United_Kingdom", 2016).explore
    .'filter data'.'Type is'.'Events[edit]'.then
    .'filter data'
       .'Entry contains'("question time")
       .'or Entry contains'("votes to leave")
       .'or Entry contains'("calm the markets")
       .'or Entry contains'("may is announced").then
    .'sort data'.'by Date'.then

let labels = 
  [ "Question Time", "Brexit vote", 
    "Osborne statement", "May Prime Minister" ]

let labelledMarkers = 
  series.values(labels)
    .joinInner(markers.'get the data')

list.create(labelledMarkers)
  .setTags("ul", "li")
  .setFormat(fun v -> "<strong>" + v.first + " (" + 
     dateformat.longDate(v.second.Date) + ")</strong> - " + v.second.Entry)
  .show("gbpusd-brexit-list")
  
youguess.vlineOffset(gbpusd).setSize(420, 750)
  .setLabels(labels)
  .setAxisY(label="", labelOffset=80, 
     minValue=date.date(2016,6,4), maxValue=date.date(2016,7,21))  
  .setAxisX(minValue=1, maxValue=2)  
  .setMarkers(markers.'get series'.'with key Date'.'and value Entry')
  .setColors("#000000","#9467bd","#803000")
  .setInteractive(false)
</script>
<script type="text/javascript">
thegamma.push({id:"gbpusd-brexit", title:"Yadda"});
</script>


    <div class="row">
      <div class="col-sm-10 col-lg-8">
        <h2><span>Guess what events matter</span></h2>
        <p>
          If you see the events on a chart, it is easy to make a guess about what the 
          trends might have been and what the effect of the events was. But can you guess
          which events matter will make the price go down or up on your own? In this 
          section, you get to try. We show you a line charting the price, but you have
          to guess how it aligns with the events. To get started, click on the charts and
          then drag up or down with your cursor or fingers.
        </p>
      </div>
    </div>
  

    <div class="row">
      <div class="col-sm-6">
        <h3><span>Gold price during financial crisis</span></h3>
        <p>First, let's go back to the financial crisis of 2008. In uncertain times,
          gold is one of the commodities that people purchase and that gain in price.
          Did people expect the crash and start buying gold before the crash, or did
          the price of gold start rising after? Here are a couple of events that may
          (or may not) have had effect on the price of gold:</p>
        <div class="thegamma" id="gold-crash-list"></div>
        <p>Can you move the line representing the price of gold to the right
          position in the following chart? We loaded the price for a bit before May 2008 and
          a bit after April 2009, but you need to guess how the events align with the price!</p>
      </div>
      <div class="col-sm-4">
        <div class="hidden-xs" style="height:60px"></div>
        <div class="thegamma" id="gold-crash"></div>
      </div>
    </div>

<script type="text/thegamma" id="gold-crash-code">let gold =
  shared.'by date'.'July 2017'.'Price Of Gold'
    .'filter data'.'Date is in range'(date.date(2007,1,1), date.date(2011,1,1)).then
    .'get series'.'with key Date'.'and value Pound Sterling'

compost.charts.line(gold)

let markers1 = 
  web.scrapeDatedLists("https://en.wikipedia.org/wiki/2008_in_the_United_States", 2008).explore
    .'filter data'.'Type is'.'Events[edit]'
        .'and Date is greater than'(date.date(2008,8,31)).then
    .'filter data'
       .'Entry contains'("wall street")
       .'or Entry contains'("palin")
       .'or Entry contains'("financial panic").then
    .'sort data'.'by Date'.then

let markers2 = 
  web.scrapeDatedLists("https://en.wikipedia.org/wiki/2009_in_the_United_States", 2009).explore
    .'filter data'.'Type is'.'Events[edit]'.then
    .'filter data'
       .'Entry contains'("obama is inaugurated")
       .'or Entry contains'("aig reports").then
    .'sort data'.'by Date'.then

let labels =     
  ["McCain & Palin", "Lehman Brothers", "Dow Jones crash", "Obama inaugurated", "AIG losses"]

let markers = 
  markers1.'get series'.'with key Date'.'and value Entry'
    .append(markers2.'get series'.'with key Date'.'and value Entry')

let labelledMarkers = 
  series.values(labels)
    .joinInner(markers1.'get the data'
      .append(markers2.'get the data'.mapKeys(fun k -> k + 3)))
  
list.create(labelledMarkers)
  .setTags("ul", "li")
  .setFormat(fun v -> "<strong>" + v.first + " (" + 
     dateformat.longDate(v.second.Date) + ")</strong> - " + v.second.Entry)
  .show("gold-crash-list")
  
youguess.vlineOffset(gold).setSize(420, 750)
  .setAxisY(label="", labelOffset=80, 
     minValue=date.date(2008,5,1), maxValue=date.date(2009,5,5))
  .setAxisX(minValue=200, maxValue=1000)  
  .setMarkers(markers)
  .setLabels(labels)
  .setColors("#57a4cd","#bd6794","#800030")
</script>
<script type="text/javascript">
thegamma.push({id:"gold-crash"});
</script>


    <div class="row">
      <div class="col-sm-6">
        <h3>Effect of Brexit on London Stock Exchange</h3>
        <p>For our second example, we will agian use Brexit. This time, we look at the effect on 
          FTSE rather than on the value of pound. The FTSE 100 index is calculated based on the 
          share prices of the 100 largest companies traded at the London Stock Exchange. This 
          includes a mix of international and British companies such as BP, Tesco, Barclays or 
          EasyJet. Guess how the following events align wth the FTSE price:</p>
        <div class="thegamma" id="ftse-brexit-list"></div>
        <p>Are we suggesting that the succesfull return of British astronaut Tim Peake
          had an effect on the value of FTSE? If you did not know what the events are and
          looked just on the chart with labels, perhaps you might think it does. The lesson
          is simple - guessing which events really matter requires human judgement!</p>
      </div>
      <div class="col-sm-4">
        <div class="hidden-xs" style="height:60px"></div>
        <div class="thegamma" id="ftse-brexit"></div>
      </div>
    </div>

<script type="text/thegamma" id="ftse-brexit-code">let ftse100 = shared.'by date'.'August 2017'.'FTSE100 (2012-2017)'
    .'filter data'.'Date is in range'(date.date(2016,5,1), date.date(2016,8,1)).then
    .'get series'.'with key Date'.'and value Close'

let markers = 
  web.scrapeDatedLists("https://en.wikipedia.org/wiki/2016_in_the_United_Kingdom", 2016).explore
    .'filter data'.'Type is'.'Events[edit]'.then
    .'filter data'
       .'Entry contains'("votes to leave")
       .'or Entry contains'("tim peake returns")
       .'or Entry contains'("jo cox dies")
       .'or Entry contains'("aaa credit").then
    .'sort data'.'by Date'.then

let labels =     
  ["Jo Cox", "Tim Peake", "Brexit vote","Standard & Poor"]

let labelledMarkers = 
  series.values(labels)
    .joinInner(markers.'get the data')
  
list.create(labelledMarkers)
  .setTags("ul", "li")
  .setFormat(fun v -> "<strong>" + v.first + " (" + 
     dateformat.longDate(v.second.Date) + ")</strong> - " + v.second.Entry)
  .show("ftse-brexit-list")
  
youguess.vlineOffset(ftse100).setSize(420, 750)
  .setAxisY(label="", labelOffset=80, 
     minValue=date.date(2016,6,9), maxValue=date.date(2016,7,3))
  .setAxisX(minValue=5500, maxValue=7000)
  .setLabels(labels)
  .setMarkers(markers.'get series'.'with key Date'.'and value Entry')
  .setColors("#94bd67","#bd9467","#803000")
</script>
<script type="text/javascript">
thegamma.push({id:"ftse-brexit"});
</script>

</article>
<footer>
  <div class="container">
    <div calss="row">
      <div class="col-sm-5">
        <h4>About the project</h4>
        <p>
          This page has been created by Tomas Petricek and May Yong using <a href="https://thegamma.net/">The Gamma</a>,
          an innovative open-source visualization tools that lets you create transparent data-driven visualizations.
        </p>
        <p>
          To find out more, check out <a href="https://thegamma.net/">The Gamma homepage</a> and source on 
          <a href="https://github.com/the-gamma">GitHub</a>. For updates, follow
          <a href="https://twitter.com/thegamma_net">@thegamma_net</a> and <a href="https://twitter.com/tomaspetricek">@tomaspetricek</a>.
          Send your comments to Tomas at <a href="mailto:tomas@tomasp.net">tomas@tomasp.net</a>.
        </p>
      </div>
      <div class="col-sm-4">
        <h4>Privacy policy</h4>
        <p>For further research purposes, this page collects anonymous usage data about the choices made in the interactive 
          visualizations and changes made to source code of snippets.</p>
        <p>In addition, we are using
          Google Analytics, which collects information about page views and uses tracking cookies.</p>
      </div>
      <div class="col-sm-3">
        <p style="text-align:center;padding-top:40px">
          <img src="../img/turing.png" style="width:200px;opacity:0.2"/>
        </p>
      </div>
    </div>
  </div>
</footer>

<div class="thegamma">
<div id="thegamma-sizer" class="thegamma-sizer"></div>
<div id="thegamma-dialog" class="thegamma-dialog">
  <div id="thegamma-dialog-window" class="thegamma-dialog-window">
    <div class="header"><a href="javascript:closeDialog();">&times;</a><span>Edit source code</span></div>
    <div class="body"><div id="thegamma-ed"></div><div id="thegamma-errors" class="errors"></div>
      <button id="thegamma-update">Update page</button></div>
  </div>
</div>
</div>

<script type="text/javascript" src="https://thegamma.net/lib/thegamma-0.1/babel.min.js"></script>
<script type="text/javascript" src="https://thegamma.net/lib/thegamma-0.1/core-js.min.js"></script>
<script type="text/javascript" src="https://thegamma.net/lib/thegamma-0.1/require.js"></script>
<script type="text/javascript" src="https://www.google.com/jsapi"></script>
<script type="text/javascript" src="/lib/embed.js"></script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65311433-2', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
